import{_ as pe,r as i,u as he,s as W,w as X,o as ye,i as I,b as v,d as be,e as B,f as y,g as l,p as _,h as Z,j as e,k as o,l as t,m as L,n as ee,E as Le}from"../3rdPlugin/3rdPlugin.CEm3-_ST.js";import{U as De,a as g}from"../usr-descriptions-item/usr-descriptions-item.B4SysKXi.js";const ze={class:"page"},we={class:"top_btn_panel"},Te={class:"action_btn"},Ce={class:"dialog-footer"},Ie={class:"dialog-footer"},ke={class:"dialog-footer"},Ve={class:"usr_log_login_panel"},Se={key:0,style:{padding:"0 20px"}},qe={class:"code_info"},Ae={class:"code_info"},Re={style:{flex:"auto"}},Ne={__name:"page-login",setup(Ue){const c=i({userName:"",location:"",status:"0",startTime:"",endTime:"",pageNum:1,pageSize:10}),V=i([]),S=i(!1),M=i([]),$=i(0),le=he(),s=W(()=>le.currentLang),a=W(()=>({username:s.value==="zh"?"用户名":"Username",loginAddress:s.value==="zh"?"登录地址":"Login Address",loginTime:s.value==="zh"?"登录时间":"Login Time",status:s.value==="zh"?"状态":"Status",startTime:s.value==="zh"?"开始时间":"Start Time",endTime:s.value==="zh"?"结束时间":"End Time",selectStatus:s.value==="zh"?"选择状态":"Select Status",normal:s.value==="zh"?"正常":"Normal",failed:s.value==="zh"?"失败":"Failed",search:s.value==="zh"?"搜索":"Search",deleteByDate:s.value==="zh"?"按日期删除":"Delete by Date",deleteAll:s.value==="zh"?"删除全部":"Delete All",details:s.value==="zh"?"详情":"Details",delete:s.value==="zh"?"删除":"Delete",cancel:s.value==="zh"?"取消":"Cancel",confirm:s.value==="zh"?"确定":"Confirm",close:s.value==="zh"?"关闭":"Close",recordId:s.value==="zh"?"记录ID":"Record ID",requestMethod:s.value==="zh"?"请求方式":"Request Method",requestIP:s.value==="zh"?"请求IP":"Request IP",browser:s.value==="zh"?"浏览器":"Browser",os:s.value==="zh"?"操作系统":"Operating System",loginDuration:s.value==="zh"?"登录耗时(MS)":"Login Duration (MS)",operations:s.value==="zh"?"操作":"Operations",deleteConfirmation:s.value==="zh"?"删除确认":"Delete Confirmation",deleteDateRangeConfirm:(u,d)=>s.value==="zh"?`确定删除【${u}】-【${d}】的登录日志吗？`:`Are you sure you want to delete login logs from ${u} to ${d}?`,deleteAllConfirm:s.value==="zh"?"确定清空全部登录日志吗？":"Are you sure you want to delete all login logs?",deleteLogConfirm:u=>s.value==="zh"?`确定删除【${u}】的这条登录日志吗？`:`Are you sure you want to delete this login log for ${u}?`,pleaseSelectDateRange:s.value==="zh"?"请选择要删除的日期范围！":"Please select a date range to delete!",noData:s.value==="zh"?"暂无数据":"No Data",logDetails:s.value==="zh"?"日志详情":"Log Details",logNumber:s.value==="zh"?"日志编号":"Log Number",requestURL:s.value==="zh"?"请求URL":"Request URL",requestParams:s.value==="zh"?"请求参数":"Request Parameters",duration:s.value==="zh"?"耗时(MS)":"Duration (MS)",result:s.value==="zh"?"结果":"Result"}));X(V,u=>{if(!u||u.length===0){c.value.startTime="",c.value.endTime="";return}c.value.startTime=u[0],c.value.endTime=u[1]}),ye(()=>{b()});const b=()=>{S.value=!0,I.post("/sysLogLogin/selectSysLogLoginList",{...c.value}).then(u=>{M.value=u.data.list||[],$.value=u.data.total||0}).catch(u=>{console.error(u)}).finally(()=>{S.value=!1})},ae=u=>{c.value.pageNum=u,b()},te=()=>{c.value.pageNum=1,b()},h=i({startTime:"",endTime:""}),q=i([]),P=i(""),D=i(!1),A=i(!1);X(q,u=>{if(!u||u.length===0){h.value.startTime="",h.value.endTime="";return}h.value.startTime=u[0],h.value.endTime=u[1]});const oe=()=>{if(h.value.startTime===""||h.value.endTime===""){Le.warning(a.value.pleaseSelectDateRange);return}P.value=a.value.deleteDateRangeConfirm(h.value.startTime,h.value.endTime),D.value=!0},ne=()=>{A.value=!0,I.post("/sysLogLogin/deleteSysLogLoginByTime",{...h.value}).then(u=>{b()}).catch(u=>{console.error(u)}).finally(()=>{D.value=!1,A.value=!1})},Y=i(""),z=i(!1),R=i(!1),ue=()=>{Y.value=a.value.deleteAllConfirm,z.value=!0},se=()=>{R.value=!0,I.post("/sysLogLogin/cleanSysLogLogin",{}).then(u=>{b()}).catch(u=>{console.error(u)}).finally(()=>{z.value=!1,R.value=!1})},E=i(""),w=i(!1),F=i(""),N=i(!1),de=u=>{E.value=u.logId,F.value=a.value.deleteLogConfirm(u.userName),w.value=!0},ie=()=>{N.value=!0,I.post("/sysLogLogin/deleteSysLogLogin",{logId:E.value}).then(u=>{b()}).catch(u=>{console.error(u)}).finally(()=>{w.value=!1,N.value=!1})},r=i({}),k=i(!1),U=i(!1),re=u=>{r.value={},k.value=!0,U.value=!0,I.post("/sysLogLogin/selectSysLogLoginInfo",{logId:u.logId}).then(d=>{r.value=d.data||{}}).catch(d=>{console.error(d),r.value={}}).finally(()=>{U.value=!1})};return(u,d)=>{const O=v("el-input"),T=v("el-form-item"),j=v("el-date-picker"),G=v("el-option"),ve=v("el-select"),f=v("el-button"),H=v("el-form"),J=v("el-card"),p=v("el-table-column"),C=v("el-tag"),K=v("el-empty"),ce=v("el-table"),me=v("el-pagination"),x=v("el-dialog"),m=v("el-text"),ge=v("el-scrollbar"),fe=v("el-drawer"),Q=be("loading");return y(),B("div",ze,[l(J,{shadow:"never",class:"usr_card_override top"},{default:e(()=>[l(H,{inline:!0,model:c.value},{default:e(()=>[l(T,{label:a.value.username},{default:e(()=>[l(O,{modelValue:c.value.userName,"onUpdate:modelValue":d[0]||(d[0]=n=>c.value.userName=n),maxlength:"10",placeholder:a.value.username,clearable:"",style:{width:"180px"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(T,{label:a.value.loginAddress},{default:e(()=>[l(O,{modelValue:c.value.location,"onUpdate:modelValue":d[1]||(d[1]=n=>c.value.location=n),maxlength:"10",placeholder:a.value.loginAddress,clearable:"",style:{width:"180px"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(T,{label:a.value.loginTime},{default:e(()=>[l(j,{modelValue:V.value,"onUpdate:modelValue":d[2]||(d[2]=n=>V.value=n),type:"daterange",editable:!1,"start-placeholder":a.value.startTime,"end-placeholder":a.value.endTime,size:"default","value-format":"YYYY-MM-DD"},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),l(T,{label:a.value.status},{default:e(()=>[l(ve,{modelValue:c.value.status,"onUpdate:modelValue":d[3]||(d[3]=n=>c.value.status=n),size:"default",placeholder:a.value.selectStatus,clearable:"",style:{width:"180px"}},{default:e(()=>[l(G,{label:a.value.normal,value:"0"},null,8,["label"]),l(G,{label:a.value.failed,value:"-1"},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(T,null,{default:e(()=>[l(f,{type:"primary",plain:"",onClick:te},{default:e(()=>[o(t(a.value.search),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),_("div",we,[l(H,{inline:!0,model:h.value},{default:e(()=>[l(j,{modelValue:q.value,"onUpdate:modelValue":d[4]||(d[4]=n=>q.value=n),type:"daterange",editable:!1,"start-placeholder":a.value.startTime,"end-placeholder":a.value.endTime,size:"default","value-format":"YYYY-MM-DD"},null,8,["modelValue","start-placeholder","end-placeholder"]),l(f,{type:"warning",plain:"",onClick:oe},{default:e(()=>[o(t(a.value.deleteByDate),1)]),_:1}),l(f,{type:"danger",plain:"",onClick:ue},{default:e(()=>[o(t(a.value.deleteAll),1)]),_:1})]),_:1},8,["model"])]),Z((y(),L(J,{shadow:"never",class:"usr_card_override content"},{default:e(()=>[l(ce,{class:"log_login_table",data:M.value,"row-key":"logId"},{empty:e(()=>[l(K,{description:a.value.noData},null,8,["description"])]),default:e(()=>[l(p,{label:a.value.recordId,width:"100",align:"center"},{default:e(n=>[o(t(n.row.logId),1)]),_:1},8,["label"]),l(p,{label:a.value.username,width:"120"},{default:e(n=>[o(t(n.row.userName),1)]),_:1},8,["label"]),l(p,{label:a.value.requestMethod,width:"130",align:"center"},{default:e(n=>[o(t(n.row.reqType),1)]),_:1},8,["label"]),l(p,{label:a.value.requestIP,width:"150",align:"center"},{default:e(n=>[o(t(n.row.ipAddr),1)]),_:1},8,["label"]),l(p,{label:a.value.loginAddress,width:"180"},{default:e(n=>[o(t(n.row.location),1)]),_:1},8,["label"]),l(p,{label:a.value.browser,width:"120",align:"center"},{default:e(n=>[o(t(n.row.browser),1)]),_:1},8,["label"]),l(p,{label:a.value.os,width:"120",align:"center"},{default:e(n=>[o(t(n.row.os),1)]),_:1},8,["label"]),l(p,{label:a.value.loginDuration,width:"120",align:"center"},{default:e(n=>[o(t(n.row.costTime),1)]),_:1},8,["label"]),l(p,{label:a.value.loginTime,width:"200"},{default:e(n=>[o(t(n.row.createTime),1)]),_:1},8,["label"]),l(p,{label:a.value.status,align:"center"},{default:e(n=>[n.row.status===0?(y(),L(C,{key:0},{default:e(()=>[o(t(a.value.normal),1)]),_:1})):n.row.status===-1?(y(),L(C,{key:1,type:"danger"},{default:e(()=>[o(t(a.value.failed),1)]),_:1})):ee("",!0)]),_:1},8,["label"]),l(p,{fixed:"right",label:a.value.operations,width:"220"},{default:e(n=>[_("div",Te,[l(f,{type:"primary",plain:"",onClick:_e=>re(n.row)},{default:e(()=>[o(t(a.value.details),1)]),_:2},1032,["onClick"]),l(f,{type:"info",plain:"",onClick:_e=>de(n.row)},{default:e(()=>[o(t(a.value.delete),1)]),_:2},1032,["onClick"])])]),_:1},8,["label"])]),_:1},8,["data"]),l(me,{background:"",layout:"prev, pager, next","current-page":c.value.pageNum,onCurrentChange:ae,"page-size":c.value.pageSize,total:$.value},null,8,["current-page","page-size","total"])]),_:1})),[[Q,S.value]]),l(x,{modelValue:D.value,"onUpdate:modelValue":d[6]||(d[6]=n=>D.value=n),title:a.value.deleteConfirmation,width:"500"},{footer:e(()=>[_("div",Ce,[l(f,{onClick:d[5]||(d[5]=n=>D.value=!1)},{default:e(()=>[o(t(a.value.cancel),1)]),_:1}),l(f,{type:"primary",onClick:ne,loading:A.value},{default:e(()=>[o(t(a.value.confirm),1)]),_:1},8,["loading"])])]),default:e(()=>[_("span",null,t(P.value),1)]),_:1},8,["modelValue","title"]),l(x,{modelValue:z.value,"onUpdate:modelValue":d[8]||(d[8]=n=>z.value=n),title:a.value.deleteConfirmation,width:"500"},{footer:e(()=>[_("div",Ie,[l(f,{onClick:d[7]||(d[7]=n=>z.value=!1)},{default:e(()=>[o(t(a.value.cancel),1)]),_:1}),l(f,{type:"primary",onClick:se,loading:R.value},{default:e(()=>[o(t(a.value.confirm),1)]),_:1},8,["loading"])])]),default:e(()=>[_("span",null,t(Y.value),1)]),_:1},8,["modelValue","title"]),l(x,{modelValue:w.value,"onUpdate:modelValue":d[10]||(d[10]=n=>w.value=n),title:a.value.deleteConfirmation,width:"500"},{footer:e(()=>[_("div",ke,[l(f,{onClick:d[9]||(d[9]=n=>w.value=!1)},{default:e(()=>[o(t(a.value.cancel),1)]),_:1}),l(f,{type:"primary",onClick:ie,loading:N.value},{default:e(()=>[o(t(a.value.confirm),1)]),_:1},8,["loading"])])]),default:e(()=>[_("span",null,t(F.value),1)]),_:1},8,["modelValue","title"]),l(fe,{class:"usr_drawer_log_login_info",modelValue:k.value,"onUpdate:modelValue":d[12]||(d[12]=n=>k.value=n),direction:"rtl",size:"500"},{header:e(()=>[_("h4",null,t(a.value.logDetails),1)]),default:e(()=>[Z((y(),B("div",Ve,[l(ge,null,{default:e(()=>[Object.keys(r.value).length!==0?(y(),B("div",Se,[l(De,{direction:"column"},{default:e(()=>[l(g,null,{name:e(()=>[l(m,{type:"info"},{default:e(()=>[o(t(a.value.logNumber)+"：",1)]),_:1})]),desc:e(()=>[o(t(r.value.logId),1)]),_:1}),l(g,null,{name:e(()=>[l(m,{type:"info"},{default:e(()=>[o(t(a.value.username)+"：",1)]),_:1})]),desc:e(()=>[o(t(r.value.userName),1)]),_:1}),l(g,null,{name:e(()=>[l(m,{type:"info"},{default:e(()=>[o(t(a.value.requestURL)+"：",1)]),_:1})]),desc:e(()=>[o(t(r.value.reqUrl),1)]),_:1}),l(g,null,{name:e(()=>[l(m,{type:"info"},{default:e(()=>[o(t(a.value.requestMethod)+"：",1)]),_:1})]),desc:e(()=>[l(C,null,{default:e(()=>[o(t(r.value.reqType),1)]),_:1})]),_:1}),l(g,null,{name:e(()=>[l(m,{type:"info"},{default:e(()=>[o(t(a.value.requestParams)+"：",1)]),_:1})]),desc:e(()=>[_("div",qe,t(r.value.reqParam),1)]),_:1}),l(g,null,{name:e(()=>[l(m,{type:"info"},{default:e(()=>[o(t(a.value.requestIP)+"：",1)]),_:1})]),desc:e(()=>[o(t(r.value.ipAddr),1)]),_:1}),l(g,null,{name:e(()=>[l(m,{type:"info"},{default:e(()=>[o(t(a.value.loginAddress)+"：",1)]),_:1})]),desc:e(()=>[o(t(r.value.location),1)]),_:1}),l(g,null,{name:e(()=>[l(m,{type:"info"},{default:e(()=>[o(t(a.value.browser)+"：",1)]),_:1})]),desc:e(()=>[o(t(r.value.browser),1)]),_:1}),l(g,null,{name:e(()=>[l(m,{type:"info"},{default:e(()=>[o(t(a.value.os)+"：",1)]),_:1})]),desc:e(()=>[o(t(r.value.os),1)]),_:1}),l(g,null,{name:e(()=>[l(m,{type:"info"},{default:e(()=>[o(t(a.value.loginTime)+"：",1)]),_:1})]),desc:e(()=>[o(t(r.value.createTime),1)]),_:1}),l(g,null,{name:e(()=>[l(m,{type:"info"},{default:e(()=>[o(t(a.value.duration)+"：",1)]),_:1})]),desc:e(()=>[o(t(r.value.costTime),1)]),_:1}),l(g,null,{name:e(()=>[l(m,{type:"info"},{default:e(()=>[o(t(a.value.status)+"：",1)]),_:1})]),desc:e(()=>[r.value.status===0?(y(),L(C,{key:0},{default:e(()=>[o(t(a.value.normal),1)]),_:1})):r.value.status===-1?(y(),L(C,{key:1,type:"danger"},{default:e(()=>[o(t(a.value.failed),1)]),_:1})):ee("",!0)]),_:1}),l(g,null,{name:e(()=>[l(m,{type:"info"},{default:e(()=>[o(t(a.value.result)+"：",1)]),_:1})]),desc:e(()=>[_("div",Ae,t(r.value.result),1)]),_:1})]),_:1})])):(y(),L(K,{key:1,description:a.value.noData},null,8,["description"]))]),_:1})])),[[Q,U.value]])]),footer:e(()=>[_("div",Re,[l(f,{onClick:d[11]||(d[11]=n=>k.value=!1)},{default:e(()=>[o(t(a.value.close),1)]),_:1})])]),_:1},8,["modelValue"])])}}},Me=pe(Ne,[["__scopeId","data-v-2a8efda8"]]);export{Me as default};
