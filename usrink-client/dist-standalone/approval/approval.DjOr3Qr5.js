import{_ as W,b as u,e as f,f as h,g as t,j as s,p as r,k as i,l as n,F as X,A as Z,m as B,n as N,y as V,r as _,u as $,s as H,Q as ee,o as ae,I as le,J as oe,i as I,E as T}from"../3rdPlugin/3rdPlugin.CEm3-_ST.js";const te={setup(){const y=_([]),p=_(!1),C=_(!1),e=_({}),S=_(0),j=_(0),v=_([]),R=_(null),b=_(""),d=_(!1),k=$(),l=H(()=>k.currentLang),c=H(()=>({pendingApprovals:l.value==="zh"?"待办审批":"Pending Approvals",approvalHistory:l.value==="zh"?"审批历史":"Approval History",selectApproverIdentity:l.value==="zh"?"选择审批身份":"Select Approver Identity",deviceApprovalRecords:l.value==="zh"?"设备审批记录":"Device Approval Records",costCenter:l.value==="zh"?"成本中心":"Cost Center",applicationTime:l.value==="zh"?"申请时间":"Application Time",updateTime:l.value==="zh"?"更新时间":"Update Time",applicant:l.value==="zh"?"申请人":"Applicant",responsible:l.value==="zh"?"责任人":"Responsible Person",computerType:l.value==="zh"?"电脑类型":"Computer Type",computerToReplace:l.value==="zh"?"需要更换的电脑":"Computer to Replace",applicationReason:l.value==="zh"?"申请理由":"Application Reason",approvalReason:l.value==="zh"?"审批理由":"Approval Reason",status:l.value==="zh"?"状态":"Status",actions:l.value==="zh"?"操作":"Actions",view:l.value==="zh"?"查看":"View",approve:l.value==="zh"?"审批通过":"Approve",reject:l.value==="zh"?"审批不通过":"Reject",agree:l.value==="zh"?"同意":"Agree",disagree:l.value==="zh"?"驳回":"Reject",flowNotReached:l.value==="zh"?"流程未到达":"Process Not Reached",approvalAction:l.value==="zh"?"审批":"Approve",applyForNewComputer:l.value==="zh"?"申请新电脑":"Apply for new computer",applicationType:l.value==="zh"?"申请类别":"Application Type",company:l.value==="zh"?"所属公司":"Company",computerSituation:l.value==="zh"?"电脑情形":"Computer Situation",companySystem:l.value==="zh"?"公司系统":"Company System",approvalNotReached:l.value==="zh"?"上一级审批尚未完成，流程未到达":"Previous approval not complete, process not reached",approvalHistoryMessage:l.value==="zh"?"您已进行审批，审批历史为":"You have already approved, history is",enterRejectReason:l.value==="zh"?"请输入审批不通过理由":"Please Enter Rejection Reason",enterRejectReasonPlaceholder:l.value==="zh"?"请输入审批不通过的理由":"Please enter reason for rejection",cancel:l.value==="zh"?"取消":"Cancel",confirm:l.value==="zh"?"确认":"Confirm",pending:l.value==="zh"?"待审批":"Pending",approving:l.value==="zh"?"审批中":"In Approval",approved:l.value==="zh"?"审批通过":"Approved",rejected:l.value==="zh"?"审批不通过":"Rejected",pendingOld:"Pending",approvedOld:"已通过",rejectedOld:"已驳回",approverNotFound:l.value==="zh"?"未找到您的审批身份信息":"Your approver identity not found",approvalSuccess:l.value==="zh"?"审批操作成功":"Approval successful",approvalFailed:l.value==="zh"?"审批操作失败":"Approval failed",approvalProcessFailed:l.value==="zh"?"审批操作失败":"Approval process failed",approvalNotComplete:l.value==="zh"?"上一级审批尚未完成，暂不能进行审批操作":"Previous approval not complete, cannot proceed",pleaseEnterReason:l.value==="zh"?"请输入审批不通过的理由":"Please enter a reason for rejection"})),g=ee({pageNum:1,pageSize:10,approvalType:0,approverId:null}),m=()=>{I.post("/sysApply/getApproverList").then(a=>{a.code===200&&a.data&&a.data.list&&a.data.list.length>0?(v.value=a.data.list,R.value=a.data.list[0].id,g.approverId=a.data.list[0].id,o()):T.warning(c.value.approverNotFound)}).catch(a=>{console.error("获取审批人列表失败",a),T.error(l.value==="zh"?"获取审批人身份失败":"Failed to get approver identity")})},D=a=>a==="审批中"?c.value.approving:a==="审批通过"?c.value.approved:a==="审批不通过"?c.value.rejected:a==="待审批"||a==="Pending"?c.value.pending:a==="已通过"?c.value.approved:a==="已驳回"?c.value.rejected:a,w=a=>{g.approverId=a,g.pageNum=1,o()},P=a=>{j.value=a,g.approvalType=a,g.pageNum=1,o()},o=()=>{if(!g.approverId)return;p.value=!0;const a={...g};I.post("/sysApply/getApprovalListById",a).then(A=>{y.value=A.data.list||[],S.value=A.data.total||0}).catch(A=>{console.error("获取审批记录失败",A)}).finally(()=>{p.value=!1})},L=a=>{g.pageNum=a,o()},E=a=>a.status==="审批中"?a.status1Signal===0?c.value.flowNotReached:c.value.approvalAction:c.value.view,U=a=>{e.value={...a},C.value=!0},M=a=>{if(e.value.status1Signal===0){T.warning(c.value.approvalNotComplete);return}a?F(!0,null):(C.value=!1,d.value=!0)},F=(a,A)=>{const G=a?e.value.status==="审批中"?"审批通过":"已通过":e.value.status==="审批中"?"审批不通过":"已驳回",K={id:e.value.approvalId,flowId:e.value.flowId,status:G,approvedAt:new Date().toISOString(),reason:A};I.post("/sysApply/processApproval",K,{headers:{"Content-Type":"application/json"}}).then(x=>{x.code===200?(T.success(x.msg||c.value.approvalSuccess),o(),C.value=!1,d.value=!1,b.value=""):T.error(x.msg||c.value.approvalFailed)}).catch(x=>{console.error("审批操作失败",x),T.error(c.value.approvalProcessFailed+": "+(x.message||"未知错误"))})},O=()=>{if(!b.value.trim()){T.warning(c.value.pleaseEnterReason);return}F(!1,b.value)},Y=()=>{d.value=!1,b.value=""},J=a=>a==="待审批"||a==="审批中"||a==="Pending"?"primary":a==="已通过"||a==="审批通过"?"success":a==="已驳回"||a==="审批不通过"?"danger":"",Q=a=>a==="已通过"||a==="审批通过"?"approval-success":a==="已驳回"||a==="审批不通过"?"approval-danger":"",q=a=>({"Standard Notebook":"Standard Notebook","Performance Notebook":"Performance Notebook","Standard Desktop":"Standard Desktop","Performance Desktop":"Performance Desktop",normalLaptop:"Standard Notebook",workstationLaptop:"Performance Notebook",normalDesktop:"Standard Desktop",workstationDesktop:"Performance Desktop"})[a]||a;return ae(()=>{m()}),{approvalList:y,loading:p,approvalDialogVisible:C,selectedApproval:e,viewApprovalDetails:U,approveApplication:M,statusTagType:J,getDeviceTypeName:q,pageData:g,total:S,handleCurrentChange:L,approvalType:j,switchApprovalType:P,getApprovalHistoryClass:Q,getActionButtonText:E,approverList:v,selectedApproverId:R,handleApproverChange:w,approvalReason:b,rejectDialogVisible:d,confirmReject:O,cancelReject:Y,currentLang:l,langText:c,getLocalizedStatus:D}}},z=y=>(le("data-v-b3bb8c64"),y=y(),oe(),y),ne={style:{padding:"20px"}},se={class:"approval-tabs"},re={class:"approver-selector"},pe={class:"table-container"},ie={class:"pagination-container"},ce={key:0,class:"application-detail-container"},de={class:"detail-header"},ve={class:"application-title"},ue={class:"computer-name"},ge={class:"application-info"},me={class:"info-item"},he=z(()=>r("i",{class:"el-icon-user"},null,-1)),_e={class:"info-item"},fe=z(()=>r("i",{class:"el-icon-date"},null,-1)),ye={class:"detail-content"},be={class:"reason-section"},Ae={class:"reason-title"},Te={class:"reason-content"},ze={key:0,class:"reason-section approval-reason-section"},xe={class:"reason-title"},Ce={class:"reason-content"},Re={class:"approval-actions"},ke={key:0,class:"action-buttons"},we=z(()=>r("i",{class:"el-icon-check"},null,-1)),Ne=z(()=>r("i",{class:"el-icon-close"},null,-1)),Se={key:1,class:"approval-waiting"},je=z(()=>r("i",{class:"el-icon-warning"},null,-1)),De={key:3,class:"action-buttons"},Pe=z(()=>r("i",{class:"el-icon-check"},null,-1)),Ve=z(()=>r("i",{class:"el-icon-close"},null,-1)),Ie={class:"reject-reason-container"},Le={class:"dialog-footer"};function Fe(y,p,C,e,S,j){const v=u("el-button"),R=u("el-option"),b=u("el-select"),d=u("el-table-column"),k=u("el-tag"),l=u("el-table"),c=u("el-pagination"),g=u("el-card"),m=u("el-descriptions-item"),D=u("el-descriptions"),w=u("el-dialog"),P=u("el-input");return h(),f("div",ne,[t(g,{shadow:"never",class:"usr_card_override top"},{default:s(()=>[r("div",se,[t(v,{type:e.approvalType===0?"primary":"default",onClick:p[0]||(p[0]=o=>e.switchApprovalType(0))},{default:s(()=>[i(n(e.langText.pendingApprovals),1)]),_:1},8,["type"]),t(v,{type:e.approvalType===1?"primary":"default",onClick:p[1]||(p[1]=o=>e.switchApprovalType(1))},{default:s(()=>[i(n(e.langText.approvalHistory),1)]),_:1},8,["type"]),r("div",re,[t(b,{modelValue:e.selectedApproverId,"onUpdate:modelValue":p[2]||(p[2]=o=>e.selectedApproverId=o),placeholder:e.langText.selectApproverIdentity,onChange:e.handleApproverChange,size:"default"},{default:s(()=>[(h(!0),f(X,null,Z(e.approverList,o=>(h(),B(R,{key:o.id,label:`${o.costCenterName||e.langText.costCenter}`,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","onChange"])])]),r("h3",null,n(e.langText.deviceApprovalRecords),1),r("div",pe,[t(l,{data:e.approvalList,loading:e.loading,style:{width:"100%"},"cell-style":{padding:"12px 0"}},{default:s(()=>[t(d,{label:e.langText.applicationTime,prop:"createdAt",width:"180"},null,8,["label"]),t(d,{label:e.langText.updateTime,prop:"updatedAt",width:"180"},null,8,["label"]),t(d,{label:e.langText.applicant,prop:"userName",width:"100"},null,8,["label"]),t(d,{label:e.langText.responsible,prop:"responsibilityName",width:"100"},null,8,["label"]),t(d,{label:e.langText.computerType,prop:"deviceType",width:"180"},{default:s(({row:o})=>[i(n(e.getDeviceTypeName(o.deviceType)),1)]),_:1},8,["label"]),t(d,{label:e.langText.computerToReplace,prop:"ciName",width:"160"},{default:s(({row:o})=>[i(n(o.ciName||e.langText.applyForNewComputer),1)]),_:1},8,["label"]),t(d,{label:e.langText.applicationReason,prop:"reason","show-overflow-tooltip":"","min-width":"180"},null,8,["label"]),e.approvalType===1?(h(),B(d,{key:0,label:e.langText.approvalReason,prop:"approvalReason","show-overflow-tooltip":"","min-width":"180"},{default:s(({row:o})=>[i(n(o.approvalReason||""),1)]),_:1},8,["label"])):N("",!0),t(d,{label:e.langText.status,prop:"status",width:"140",align:"center"},{default:s(({row:o})=>[t(k,{type:e.statusTagType(o.status)},{default:s(()=>[i(n(e.getLocalizedStatus(o.status)),1)]),_:2},1032,["type"])]),_:1},8,["label"]),t(d,{label:e.langText.actions,width:"100",fixed:"right",align:"center"},{default:s(({row:o})=>[t(v,{type:"primary",text:"",onClick:L=>e.viewApprovalDetails(o),class:V({"flow-not-reached":o.status==="审批中"&&o.status1Signal===0})},{default:s(()=>[i(n(e.getActionButtonText(o)),1)]),_:2},1032,["onClick","class"])]),_:1},8,["label"])]),_:1},8,["data","loading"])]),r("div",ie,[t(c,{"current-page":e.pageData.pageNum,"onUpdate:currentPage":p[3]||(p[3]=o=>e.pageData.pageNum=o),"page-size":e.pageData.pageSize,total:e.total,onCurrentChange:e.handleCurrentChange,layout:"total, prev, pager, next, jumper",background:""},null,8,["current-page","page-size","total","onCurrentChange"])])]),_:1}),t(w,{modelValue:e.approvalDialogVisible,"onUpdate:modelValue":p[8]||(p[8]=o=>e.approvalDialogVisible=o),title:"",width:"700px",class:"application-detail-dialog","destroy-on-close":""},{default:s(()=>[e.selectedApproval?(h(),f("div",ce,[r("div",de,[r("div",ve,[r("span",ue,n(e.selectedApproval.ciName||e.langText.applyForNewComputer),1),t(k,{class:"status-tag",type:e.statusTagType(e.selectedApproval.status)},{default:s(()=>[i(n(e.getLocalizedStatus(e.selectedApproval.status)),1)]),_:1},8,["type"])]),r("div",ge,[r("span",me,[he,i(" "+n(e.langText.applicant)+": "+n(e.selectedApproval.userName),1)]),r("span",_e,[fe,i(" "+n(e.langText.applicationTime)+": "+n(e.selectedApproval.createdAt),1)])])]),r("div",ye,[t(D,{column:2,border:"",size:"default",class:"detail-descriptions"},{default:s(()=>[t(m,{label:e.langText.applicationType,"label-class-name":"item-label","content-class-name":"item-content"},{default:s(()=>[i(n(e.selectedApproval.deviceCategory),1)]),_:1},8,["label"]),t(m,{label:e.langText.computerType,"label-class-name":"item-label","content-class-name":"item-content"},{default:s(()=>[i(n(e.getDeviceTypeName(e.selectedApproval.deviceType)),1)]),_:1},8,["label"]),t(m,{label:e.langText.costCenter,"label-class-name":"item-label","content-class-name":"item-content"},{default:s(()=>[i(n(e.selectedApproval.costCenter),1)]),_:1},8,["label"]),t(m,{label:e.langText.company,"label-class-name":"item-label","content-class-name":"item-content"},{default:s(()=>[i(n(e.selectedApproval.company),1)]),_:1},8,["label"]),t(m,{label:e.langText.responsible,"label-class-name":"item-label","content-class-name":"item-content"},{default:s(()=>[i(n(e.selectedApproval.responsibilityName),1)]),_:1},8,["label"]),t(m,{label:e.langText.computerSituation,"label-class-name":"item-label","content-class-name":"item-content"},{default:s(()=>[i(n(e.selectedApproval.deviceSituation),1)]),_:1},8,["label"]),t(m,{label:e.langText.companySystem,"label-class-name":"item-label","content-class-name":"item-content"},{default:s(()=>[i(n(e.selectedApproval.companySystem),1)]),_:1},8,["label"]),t(m,{label:e.langText.updateTime,"label-class-name":"item-label","content-class-name":"item-content"},{default:s(()=>[i(n(e.selectedApproval.updatedAt),1)]),_:1},8,["label"])]),_:1}),r("div",be,[r("div",Ae,n(e.langText.applicationReason),1),r("div",Te,n(e.selectedApproval.reason),1)]),e.selectedApproval.status!=="审批中"&&e.selectedApproval.approvalReason?(h(),f("div",ze,[r("div",xe,n(e.langText.approvalReason),1),r("div",Ce,n(e.selectedApproval.approvalReason),1)])):N("",!0)]),r("div",Re,[e.selectedApproval.status==="审批中"&&e.selectedApproval.status1Signal!==0?(h(),f("div",ke,[t(v,{type:"success",size:"large",onClick:p[4]||(p[4]=o=>e.approveApplication(!0))},{default:s(()=>[we,i(" "+n(e.langText.approve),1)]),_:1}),t(v,{type:"danger",size:"large",onClick:p[5]||(p[5]=o=>e.approveApplication(!1))},{default:s(()=>[Ne,i(" "+n(e.langText.reject),1)]),_:1})])):e.selectedApproval.status==="审批中"&&e.selectedApproval.status1Signal===0?(h(),f("div",Se,[je,i(" "+n(e.langText.approvalNotReached),1)])):e.selectedApproval.status!=="Pending"?(h(),f("div",{key:2,class:V(["approval-history",e.getApprovalHistoryClass(e.selectedApproval.status)])},[r("i",{class:V(e.selectedApproval.status.includes("通过")?"el-icon-check":"el-icon-close")},null,2),i(" "+n(e.langText.approvalHistoryMessage)+": "+n(e.getLocalizedStatus(e.selectedApproval.status)),1)],2)):e.selectedApproval.status==="Pending"?(h(),f("div",De,[t(v,{type:"success",size:"large",onClick:p[6]||(p[6]=o=>e.approveApplication(!0)),disabled:e.selectedApproval.status1Signal===0},{default:s(()=>[Pe,i(" "+n(e.langText.agree),1)]),_:1},8,["disabled"]),t(v,{type:"danger",size:"large",onClick:p[7]||(p[7]=o=>e.approveApplication(!1)),disabled:e.selectedApproval.status1Signal===0},{default:s(()=>[Ve,i(" "+n(e.langText.disagree),1)]),_:1},8,["disabled"])])):N("",!0)])])):N("",!0)]),_:1},8,["modelValue"]),t(w,{modelValue:e.rejectDialogVisible,"onUpdate:modelValue":p[10]||(p[10]=o=>e.rejectDialogVisible=o),title:e.langText.enterRejectReason,width:"500px","close-on-click-modal":!1,"show-close":!0,"destroy-on-close":""},{footer:s(()=>[r("div",Le,[t(v,{onClick:e.cancelReject},{default:s(()=>[i(n(e.langText.cancel),1)]),_:1},8,["onClick"]),t(v,{type:"primary",onClick:e.confirmReject},{default:s(()=>[i(n(e.langText.confirm),1)]),_:1},8,["onClick"])])]),default:s(()=>[r("div",Ie,[t(P,{modelValue:e.approvalReason,"onUpdate:modelValue":p[9]||(p[9]=o=>e.approvalReason=o),type:"textarea",rows:4,placeholder:e.langText.enterRejectReasonPlaceholder,maxlength:"200","show-word-limit":""},null,8,["modelValue","placeholder"])])]),_:1},8,["modelValue","title"])])}const He=W(te,[["render",Fe],["__scopeId","data-v-b3bb8c64"]]);export{He as default};
