import{_ as W,u as X,r as _,w as Z,o as ee,i as le,b as i,d as te,e as U,f as m,g as l,h as ae,j as e,k as o,l as a,m as v,n as x,p as r,q as oe,v as ne}from"../3rdPlugin/3rdPlugin.CEm3-_ST.js";import{U as se,a as f}from"../usr-descriptions-item/usr-descriptions-item.B4SysKXi.js";const ie={class:"page"},ue={class:"action_btn"},de={class:"usr_email_log_panel"},re={key:0,style:{padding:"0 20px"}},ce={class:"code_info error-message"},_e={class:"email-content-section"},me={class:"email-content-actions"},pe={class:"code_info email-content"},ve={style:{flex:"auto"}},fe={class:"email-preview-container"},he={class:"email-preview-frame"},ge=["srcdoc"],be={class:"dialog-footer"},ye={__name:"page-email",setup(we){const R=X(),E={收件人:{en:"Recipient",zh:"收件人"},收件人邮箱:{en:"Recipient Email",zh:"收件人邮箱"},邮件主题:{en:"Email Subject",zh:"邮件主题"},发送时间:{en:"Send Time",zh:"发送时间"},开始时间:{en:"Start Time",zh:"开始时间"},结束时间:{en:"End Time",zh:"结束时间"},状态:{en:"Status",zh:"状态"},选择状态:{en:"Select Status",zh:"选择状态"},搜索:{en:"Search",zh:"搜索"},记录ID:{en:"Record ID",zh:"记录ID"},成功:{en:"Success",zh:"成功"},失败:{en:"Failed",zh:"失败"},操作:{en:"Actions",zh:"操作"},详情:{en:"Details",zh:"详情"},暂无数据:{en:"No Data",zh:"暂无数据"},邮件详情:{en:"Email Details",zh:"邮件详情"},"记录ID：":{en:"Record ID: ",zh:"记录ID："},"收件人：":{en:"Recipient: ",zh:"收件人："},"邮件主题：":{en:"Subject: ",zh:"邮件主题："},"发送时间：":{en:"Send Time: ",zh:"发送时间："},"发送状态：":{en:"Status: ",zh:"发送状态："},"错误信息：":{en:"Error: ",zh:"错误信息："},"邮件内容：":{en:"Content: ",zh:"邮件内容："},关闭:{en:"Close",zh:"关闭"},预览邮件:{en:"Preview Email",zh:"预览邮件"},邮件预览:{en:"Email Preview",zh:"邮件预览"}},t=n=>E[n]&&E[n][R.currentLang]||n,u=_({toEmail:"",subject:"",status:"",startTime:"",endTime:"",pageNum:1,pageSize:10}),D=_([]),V=_(!1),S=_([]),C=_(0);Z(D,n=>{if(!n||n.length===0){u.value.startTime="",u.value.endTime="";return}u.value.startTime=n[0],u.value.endTime=n[1]}),ee(()=>{k()});const k=()=>{V.value=!0,le.post("/sysEmailLog/selectSysEmailLogList",{...u.value}).then(n=>{S.value=n.data.list||[],C.value=n.data.total||0}).catch(n=>{console.error(n)}).finally(()=>{V.value=!1})},q=n=>{u.value.pageNum=n,k()},B=()=>{u.value.pageNum=1,k()},c=_({}),y=_(!1);_(!1);const w=_(!1),L=_(""),M=n=>{c.value=n||{},y.value=!0},Y=()=>{L.value=c.value.content||"",w.value=!0};return(n,d)=>{const I=i("el-input"),g=i("el-form-item"),P=i("el-date-picker"),T=i("el-option"),$=i("el-select"),b=i("el-button"),F=i("el-form"),j=i("el-card"),h=i("el-table-column"),z=i("el-tag"),N=i("el-empty"),A=i("el-table"),O=i("el-pagination"),p=i("el-text"),G=i("el-icon"),H=i("el-scrollbar"),J=i("el-drawer"),K=i("el-dialog"),Q=te("loading");return m(),U("div",ie,[l(j,{shadow:"never",class:"usr_card_override top"},{default:e(()=>[l(F,{inline:!0,model:u.value},{default:e(()=>[l(g,{label:t("收件人")},{default:e(()=>[l(I,{modelValue:u.value.toEmail,"onUpdate:modelValue":d[0]||(d[0]=s=>u.value.toEmail=s),maxlength:"50",placeholder:t("收件人邮箱"),clearable:"",style:{width:"220px"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(g,{label:t("邮件主题")},{default:e(()=>[l(I,{modelValue:u.value.subject,"onUpdate:modelValue":d[1]||(d[1]=s=>u.value.subject=s),maxlength:"50",placeholder:t("邮件主题"),clearable:"",style:{width:"220px"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(g,{label:t("发送时间")},{default:e(()=>[l(P,{modelValue:D.value,"onUpdate:modelValue":d[2]||(d[2]=s=>D.value=s),type:"daterange",editable:!1,"start-placeholder":t("开始时间"),"end-placeholder":t("结束时间"),size:"default","value-format":"YYYY-MM-DD"},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),l(g,{label:t("状态")},{default:e(()=>[l($,{modelValue:u.value.status,"onUpdate:modelValue":d[3]||(d[3]=s=>u.value.status=s),size:"default",placeholder:t("选择状态"),clearable:"",style:{width:"180px"}},{default:e(()=>[l(T,{label:t("成功"),value:"0"},null,8,["label"]),l(T,{label:t("失败"),value:"1"},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(g,null,{default:e(()=>[l(b,{type:"primary",plain:"",onClick:B},{default:e(()=>[o(a(t("搜索")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),ae((m(),v(j,{shadow:"never",class:"usr_card_override content"},{default:e(()=>[l(A,{class:"email_log_table",data:S.value,"row-key":"id"},{empty:e(()=>[l(N,{description:t("暂无数据")},null,8,["description"])]),default:e(()=>[l(h,{label:t("记录ID"),prop:"id",width:"100",align:"center"},null,8,["label"]),l(h,{label:t("收件人"),prop:"toEmail",width:"220","show-overflow-tooltip":""},null,8,["label"]),l(h,{label:t("邮件主题"),prop:"subject","min-width":"250","show-overflow-tooltip":""},null,8,["label"]),l(h,{label:t("发送时间"),prop:"createTime",width:"180"},null,8,["label"]),l(h,{label:t("状态"),width:"100",align:"center"},{default:e(s=>[s.row.status===0?(m(),v(z,{key:0,type:"success"},{default:e(()=>[o(a(t("成功")),1)]),_:1})):s.row.status===1?(m(),v(z,{key:1,type:"danger"},{default:e(()=>[o(a(t("失败")),1)]),_:1})):x("",!0)]),_:1},8,["label"]),l(h,{fixed:"right",label:t("操作"),width:"100",align:"center"},{default:e(s=>[r("div",ue,[l(b,{type:"primary",plain:"",onClick:ze=>M(s.row)},{default:e(()=>[o(a(t("详情")),1)]),_:2},1032,["onClick"])])]),_:1},8,["label"])]),_:1},8,["data"]),l(O,{background:"",layout:"prev, pager, next","current-page":u.value.pageNum,onCurrentChange:q,"page-size":u.value.pageSize,total:C.value},null,8,["current-page","page-size","total"])]),_:1})),[[Q,V.value]]),l(J,{class:"usr_drawer_email_log_info",modelValue:y.value,"onUpdate:modelValue":d[5]||(d[5]=s=>y.value=s),direction:"rtl",size:"650"},{header:e(()=>[r("h4",null,a(t("邮件详情")),1)]),default:e(()=>[r("div",de,[l(H,null,{default:e(()=>[Object.keys(c.value).length!==0?(m(),U("div",re,[l(se,{direction:"column"},{default:e(()=>[l(f,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(a(t("记录ID：")),1)]),_:1})]),desc:e(()=>[o(a(c.value.id),1)]),_:1}),l(f,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(a(t("收件人：")),1)]),_:1})]),desc:e(()=>[o(a(c.value.toEmail),1)]),_:1}),l(f,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(a(t("邮件主题：")),1)]),_:1})]),desc:e(()=>[o(a(c.value.subject),1)]),_:1}),l(f,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(a(t("发送时间：")),1)]),_:1})]),desc:e(()=>[o(a(c.value.createTime),1)]),_:1}),l(f,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(a(t("发送状态：")),1)]),_:1})]),desc:e(()=>[c.value.status===0?(m(),v(z,{key:0,type:"success"},{default:e(()=>[o(a(t("成功")),1)]),_:1})):c.value.status===1?(m(),v(z,{key:1,type:"danger"},{default:e(()=>[o(a(t("失败")),1)]),_:1})):x("",!0)]),_:1}),c.value.status===1?(m(),v(f,{key:0},{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(a(t("错误信息：")),1)]),_:1})]),desc:e(()=>[r("div",ce,a(c.value.errorMsg),1)]),_:1})):x("",!0),l(f,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(a(t("邮件内容：")),1)]),_:1})]),desc:e(()=>[r("div",_e,[r("div",me,[l(b,{type:"primary",size:"small",onClick:Y},{default:e(()=>[l(G,null,{default:e(()=>[l(oe(ne))]),_:1}),o(" "+a(t("预览邮件")),1)]),_:1})]),r("div",pe,[r("pre",null,a(c.value.content),1)])])]),_:1})]),_:1})])):(m(),v(N,{key:1,description:t("暂无数据")},null,8,["description"]))]),_:1})])]),footer:e(()=>[r("div",ve,[l(b,{onClick:d[4]||(d[4]=s=>y.value=!1)},{default:e(()=>[o(a(t("关闭")),1)]),_:1})])]),_:1},8,["modelValue"]),l(K,{modelValue:w.value,"onUpdate:modelValue":d[7]||(d[7]=s=>w.value=s),title:t("邮件预览"),width:"80%",class:"email-preview-dialog"},{footer:e(()=>[r("span",be,[l(b,{onClick:d[6]||(d[6]=s=>w.value=!1)},{default:e(()=>[o(a(t("关闭")),1)]),_:1})])]),default:e(()=>[r("div",fe,[r("div",he,[r("iframe",{srcdoc:L.value,frameborder:"0",width:"100%",height:"600px",style:{border:"1px solid #e4e7ed","border-radius":"4px"}},`\r
                    `,8,ge)])])]),_:1},8,["modelValue","title"])])}}},ke=W(ye,[["__scopeId","data-v-4467ac93"]]);export{ke as default};
