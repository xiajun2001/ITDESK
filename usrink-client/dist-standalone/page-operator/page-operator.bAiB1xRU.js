import{_ as ge,r as i,u as he,s as W,w as X,o as ye,i as I,b as c,d as be,e as M,f as y,g as l,p as _,h as Z,j as e,k as o,l as t,m as z,n as ee,E as De}from"../3rdPlugin/3rdPlugin.CEm3-_ST.js";import{U as ze,a as m}from"../usr-descriptions-item/usr-descriptions-item.B4SysKXi.js";const we={class:"page"},Te={class:"top_btn_panel"},Ce={class:"action_btn"},qe={class:"dialog-footer"},Ie={class:"dialog-footer"},Le={class:"dialog-footer"},Ve={class:"usr_log_operator_panel"},ke={key:0,style:{padding:"0 20px"}},Oe={class:"code_info"},Re={class:"code_info"},Se={class:"code_info"},Ae={style:{flex:"auto"}},Ue={__name:"page-operator",setup(Ne){const v=i({userName:"",reqMethod:"",location:"",status:"0",startTime:"",endTime:"",pageNum:1,pageSize:10}),V=i([]),k=i(!1),B=i([]),$=i(0),le=he(),n=W(()=>le.currentLang),a=W(()=>({username:n.value==="zh"?"用户名":"Username",requestMethod:n.value==="zh"?"请求方法":"Request Method",userAddress:n.value==="zh"?"用户地址":"User Address",requestTime:n.value==="zh"?"请求时间":"Request Time",startTime:n.value==="zh"?"开始时间":"Start Time",endTime:n.value==="zh"?"结束时间":"End Time",status:n.value==="zh"?"状态":"Status",selectStatus:n.value==="zh"?"选择状态":"Select Status",normal:n.value==="zh"?"正常":"Normal",failed:n.value==="zh"?"失败":"Failed",search:n.value==="zh"?"搜索":"Search",deleteByDate:n.value==="zh"?"按日期删除":"Delete by Date",deleteAll:n.value==="zh"?"删除全部":"Delete All",details:n.value==="zh"?"详情":"Details",delete:n.value==="zh"?"删除":"Delete",cancel:n.value==="zh"?"取消":"Cancel",confirm:n.value==="zh"?"确定":"Confirm",close:n.value==="zh"?"关闭":"Close",recordId:n.value==="zh"?"记录ID":"Record ID",userRole:n.value==="zh"?"用户角色":"User Role",operationDescription:n.value==="zh"?"操作描述":"Operation Description",requestType:n.value==="zh"?"请求方式":"Request Type",requestIP:n.value==="zh"?"请求IP":"Request IP",browser:n.value==="zh"?"浏览器":"Browser",os:n.value==="zh"?"操作系统":"Operating System",operationDuration:n.value==="zh"?"操作耗时(MS)":"Operation Duration (MS)",operationTime:n.value==="zh"?"操作时间":"Operation Time",operations:n.value==="zh"?"操作":"Operations",deleteConfirmation:n.value==="zh"?"删除确认":"Delete Confirmation",deleteDateRangeConfirm:(r,s)=>n.value==="zh"?`确定删除【${r}】-【${s}】的操作日志吗？`:`Are you sure you want to delete operation logs from ${r} to ${s}?`,deleteAllConfirm:n.value==="zh"?"确定清空全部操作日志吗？":"Are you sure you want to delete all operation logs?",deleteLogConfirm:r=>n.value==="zh"?`确定删除【${r}】的这条操作日志吗？`:`Are you sure you want to delete this operation log for ${r}?`,pleaseSelectDateRange:n.value==="zh"?"请选择要删除的日期范围！":"Please select a date range to delete!",noData:n.value==="zh"?"暂无数据":"No Data",logDetails:n.value==="zh"?"日志详情":"Log Details",logNumber:n.value==="zh"?"日志编号":"Log Number",requestURL:n.value==="zh"?"请求URL":"Request URL",requestParams:n.value==="zh"?"请求参数":"Request Parameters",operationAddress:n.value==="zh"?"操作地址":"Operation Address",duration:n.value==="zh"?"耗时(MS)":"Duration (MS)",result:n.value==="zh"?"结果":"Result"}));X(V,r=>{if(!r||r.length===0){v.value.startTime="",v.value.endTime="";return}v.value.startTime=r[0],v.value.endTime=r[1]}),ye(()=>{b()});const b=()=>{k.value=!0,I.post("/sysLogOperator/selectSysLogOperatorList",{...v.value}).then(r=>{B.value=r.data.list||[],$.value=r.data.total||0}).catch(r=>{console.error(r)}).finally(()=>{k.value=!1})},ae=r=>{v.value.pageNum=r,b()},te=()=>{v.value.pageNum=1,b()},h=i({startTime:"",endTime:""}),O=i([]),P=i(""),w=i(!1),R=i(!1);X(O,r=>{if(!r||r.length===0){h.value.startTime="",h.value.endTime="";return}h.value.startTime=r[0],h.value.endTime=r[1]});const oe=()=>{if(h.value.startTime===""||h.value.endTime===""){De.warning(a.value.pleaseSelectDateRange);return}P.value=a.value.deleteDateRangeConfirm(h.value.startTime,h.value.endTime),w.value=!0},ue=()=>{R.value=!0,I.post("/sysLogOperator/deleteSysLogOperatorByTime",{...h.value}).then(r=>{b()}).catch(r=>{console.error(r)}).finally(()=>{w.value=!1,R.value=!1})},Y=i(""),T=i(!1),S=i(!1),ne=()=>{Y.value=a.value.deleteAllConfirm,T.value=!0},re=()=>{S.value=!0,I.post("/sysLogOperator/cleanSysLogOperator",{}).then(r=>{b()}).catch(r=>{console.error(r)}).finally(()=>{T.value=!1,S.value=!1})},E=i(""),C=i(!1),F=i(""),A=i(!1),se=r=>{E.value=r.logId,F.value=a.value.deleteLogConfirm(r.userName),C.value=!0},de=()=>{A.value=!0,I.post("/sysLogOperator/deleteSysLogOperator",{logId:E.value}).then(r=>{b()}).catch(r=>{console.error(r)}).finally(()=>{C.value=!1,A.value=!1})},d=i({}),L=i(!1),U=i(!1),ie=r=>{d.value={},L.value=!0,U.value=!0,I.post("/sysLogOperator/selectSysLogOperatorInfo",{logId:r.logId}).then(s=>{d.value=s.data||{}}).catch(s=>{console.error(s),d.value={}}).finally(()=>{U.value=!1})};return(r,s)=>{const N=c("el-input"),D=c("el-form-item"),j=c("el-date-picker"),G=c("el-option"),ve=c("el-select"),g=c("el-button"),H=c("el-form"),J=c("el-card"),f=c("el-table-column"),q=c("el-tag"),K=c("el-empty"),ce=c("el-table"),pe=c("el-pagination"),x=c("el-dialog"),p=c("el-text"),me=c("el-scrollbar"),fe=c("el-drawer"),Q=be("loading");return y(),M("div",we,[l(J,{shadow:"never",class:"usr_card_override top"},{default:e(()=>[l(H,{inline:!0,model:v.value},{default:e(()=>[l(D,{label:a.value.username},{default:e(()=>[l(N,{modelValue:v.value.userName,"onUpdate:modelValue":s[0]||(s[0]=u=>v.value.userName=u),maxlength:"10",placeholder:a.value.username,clearable:"",style:{width:"180px"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(D,{label:a.value.requestMethod},{default:e(()=>[l(N,{modelValue:v.value.reqMethod,"onUpdate:modelValue":s[1]||(s[1]=u=>v.value.reqMethod=u),maxlength:"10",placeholder:a.value.requestMethod,clearable:"",style:{width:"180px"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(D,{label:a.value.userAddress},{default:e(()=>[l(N,{modelValue:v.value.location,"onUpdate:modelValue":s[2]||(s[2]=u=>v.value.location=u),maxlength:"10",placeholder:a.value.userAddress,clearable:"",style:{width:"180px"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(D,{label:a.value.requestTime},{default:e(()=>[l(j,{modelValue:V.value,"onUpdate:modelValue":s[3]||(s[3]=u=>V.value=u),type:"daterange",editable:!1,"start-placeholder":a.value.startTime,"end-placeholder":a.value.endTime,size:"default","value-format":"YYYY-MM-DD"},null,8,["modelValue","start-placeholder","end-placeholder"])]),_:1},8,["label"]),l(D,{label:a.value.status},{default:e(()=>[l(ve,{modelValue:v.value.status,"onUpdate:modelValue":s[4]||(s[4]=u=>v.value.status=u),size:"default",placeholder:a.value.selectStatus,clearable:"",style:{width:"180px"}},{default:e(()=>[l(G,{label:a.value.normal,value:"0"},null,8,["label"]),l(G,{label:a.value.failed,value:"-1"},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(D,null,{default:e(()=>[l(g,{type:"primary",plain:"",onClick:te},{default:e(()=>[o(t(a.value.search),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),_("div",Te,[l(H,{inline:!0,model:h.value},{default:e(()=>[l(j,{modelValue:O.value,"onUpdate:modelValue":s[5]||(s[5]=u=>O.value=u),type:"daterange",editable:!1,"start-placeholder":a.value.startTime,"end-placeholder":a.value.endTime,size:"default","value-format":"YYYY-MM-DD"},null,8,["modelValue","start-placeholder","end-placeholder"]),l(g,{type:"warning",plain:"",onClick:oe},{default:e(()=>[o(t(a.value.deleteByDate),1)]),_:1}),l(g,{type:"danger",plain:"",onClick:ne},{default:e(()=>[o(t(a.value.deleteAll),1)]),_:1})]),_:1},8,["model"])]),Z((y(),z(J,{shadow:"never",class:"usr_card_override content"},{default:e(()=>[l(ce,{class:"log_operator_table",data:B.value,"row-key":"logId"},{empty:e(()=>[l(K,{description:a.value.noData},null,8,["description"])]),default:e(()=>[l(f,{label:a.value.recordId,width:"100",align:"center"},{default:e(u=>[o(t(u.row.logId),1)]),_:1},8,["label"]),l(f,{label:a.value.username,width:"120"},{default:e(u=>[o(t(u.row.userName),1)]),_:1},8,["label"]),l(f,{label:a.value.userRole,width:"120"},{default:e(u=>[o(t(u.row.userRoleName),1)]),_:1},8,["label"]),l(f,{label:a.value.operationDescription,width:"200"},{default:e(u=>[o(t(u.row.operatorDesc),1)]),_:1},8,["label"]),l(f,{label:a.value.requestType,width:"130",align:"center"},{default:e(u=>[o(t(u.row.reqType),1)]),_:1},8,["label"]),l(f,{label:a.value.requestIP,width:"150",align:"center"},{default:e(u=>[o(t(u.row.ipAddr),1)]),_:1},8,["label"]),l(f,{label:a.value.userAddress,width:"180"},{default:e(u=>[o(t(u.row.location),1)]),_:1},8,["label"]),l(f,{label:a.value.browser,width:"120",align:"center"},{default:e(u=>[o(t(u.row.browser),1)]),_:1},8,["label"]),l(f,{label:a.value.os,width:"120",align:"center"},{default:e(u=>[o(t(u.row.os),1)]),_:1},8,["label"]),l(f,{label:a.value.operationDuration,width:"120",align:"center"},{default:e(u=>[o(t(u.row.costTime),1)]),_:1},8,["label"]),l(f,{label:a.value.operationTime,width:"200"},{default:e(u=>[o(t(u.row.createTime),1)]),_:1},8,["label"]),l(f,{label:a.value.status,align:"center"},{default:e(u=>[u.row.status===0?(y(),z(q,{key:0},{default:e(()=>[o(t(a.value.normal),1)]),_:1})):u.row.status===-1?(y(),z(q,{key:1,type:"danger"},{default:e(()=>[o(t(a.value.failed),1)]),_:1})):ee("",!0)]),_:1},8,["label"]),l(f,{fixed:"right",label:a.value.operations,width:"220"},{default:e(u=>[_("div",Ce,[l(g,{type:"primary",plain:"",onClick:_e=>ie(u.row)},{default:e(()=>[o(t(a.value.details),1)]),_:2},1032,["onClick"]),l(g,{type:"info",plain:"",onClick:_e=>se(u.row)},{default:e(()=>[o(t(a.value.delete),1)]),_:2},1032,["onClick"])])]),_:1},8,["label"])]),_:1},8,["data"]),l(pe,{background:"",layout:"prev, pager, next","current-page":v.value.pageNum,onCurrentChange:ae,"page-size":v.value.pageSize,total:$.value},null,8,["current-page","page-size","total"])]),_:1})),[[Q,k.value]]),l(x,{modelValue:w.value,"onUpdate:modelValue":s[7]||(s[7]=u=>w.value=u),title:a.value.deleteConfirmation,width:"500"},{footer:e(()=>[_("div",qe,[l(g,{onClick:s[6]||(s[6]=u=>w.value=!1)},{default:e(()=>[o(t(a.value.cancel),1)]),_:1}),l(g,{type:"primary",onClick:ue,loading:R.value},{default:e(()=>[o(t(a.value.confirm),1)]),_:1},8,["loading"])])]),default:e(()=>[_("span",null,t(P.value),1)]),_:1},8,["modelValue","title"]),l(x,{modelValue:T.value,"onUpdate:modelValue":s[9]||(s[9]=u=>T.value=u),title:a.value.deleteConfirmation,width:"500"},{footer:e(()=>[_("div",Ie,[l(g,{onClick:s[8]||(s[8]=u=>T.value=!1)},{default:e(()=>[o(t(a.value.cancel),1)]),_:1}),l(g,{type:"primary",onClick:re,loading:S.value},{default:e(()=>[o(t(a.value.confirm),1)]),_:1},8,["loading"])])]),default:e(()=>[_("span",null,t(Y.value),1)]),_:1},8,["modelValue","title"]),l(x,{modelValue:C.value,"onUpdate:modelValue":s[11]||(s[11]=u=>C.value=u),title:a.value.deleteConfirmation,width:"500"},{footer:e(()=>[_("div",Le,[l(g,{onClick:s[10]||(s[10]=u=>C.value=!1)},{default:e(()=>[o(t(a.value.cancel),1)]),_:1}),l(g,{type:"primary",onClick:de,loading:A.value},{default:e(()=>[o(t(a.value.confirm),1)]),_:1},8,["loading"])])]),default:e(()=>[_("span",null,t(F.value),1)]),_:1},8,["modelValue","title"]),l(fe,{class:"usr_drawer_log_operator_info",modelValue:L.value,"onUpdate:modelValue":s[13]||(s[13]=u=>L.value=u),direction:"rtl",size:"500"},{header:e(()=>[_("h4",null,t(a.value.logDetails),1)]),default:e(()=>[Z((y(),M("div",Ve,[l(me,null,{default:e(()=>[Object.keys(d.value).length!==0?(y(),M("div",ke,[l(ze,{direction:"column"},{default:e(()=>[l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.logNumber)+"：",1)]),_:1})]),desc:e(()=>[o(t(d.value.logId),1)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.username)+"：",1)]),_:1})]),desc:e(()=>[o(t(d.value.userName),1)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.userRole)+"：",1)]),_:1})]),desc:e(()=>[o(t(d.value.userRoleName),1)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.operationDescription)+"：",1)]),_:1})]),desc:e(()=>[o(t(d.value.operatorDesc),1)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.requestURL)+"：",1)]),_:1})]),desc:e(()=>[o(t(d.value.reqUrl),1)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.requestType)+"：",1)]),_:1})]),desc:e(()=>[l(q,null,{default:e(()=>[o(t(d.value.reqType),1)]),_:1})]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.requestMethod)+"：",1)]),_:1})]),desc:e(()=>[_("div",Oe,t(d.value.reqMethod),1)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.requestParams)+"：",1)]),_:1})]),desc:e(()=>[_("div",Re,t(d.value.reqParam),1)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.requestIP)+"：",1)]),_:1})]),desc:e(()=>[o(t(d.value.ipAddr),1)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.operationAddress)+"：",1)]),_:1})]),desc:e(()=>[o(t(d.value.location),1)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.browser)+"：",1)]),_:1})]),desc:e(()=>[o(t(d.value.browser),1)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.os)+"：",1)]),_:1})]),desc:e(()=>[o(t(d.value.os),1)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.operationTime)+"：",1)]),_:1})]),desc:e(()=>[o(t(d.value.createTime),1)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.duration)+"：",1)]),_:1})]),desc:e(()=>[o(t(d.value.costTime),1)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.status)+"：",1)]),_:1})]),desc:e(()=>[d.value.status===0?(y(),z(q,{key:0},{default:e(()=>[o(t(a.value.normal),1)]),_:1})):d.value.status===-1?(y(),z(q,{key:1,type:"danger"},{default:e(()=>[o(t(a.value.failed),1)]),_:1})):ee("",!0)]),_:1}),l(m,null,{name:e(()=>[l(p,{type:"info"},{default:e(()=>[o(t(a.value.result)+"：",1)]),_:1})]),desc:e(()=>[_("div",Se,t(d.value.result),1)]),_:1})]),_:1})])):(y(),z(K,{key:1,description:a.value.noData},null,8,["description"]))]),_:1})])),[[Q,U.value]])]),footer:e(()=>[_("div",Ae,[l(g,{onClick:s[12]||(s[12]=u=>L.value=!1)},{default:e(()=>[o(t(a.value.close),1)]),_:1})])]),_:1},8,["modelValue"])])}}},Be=ge(Ue,[["__scopeId","data-v-894630eb"]]);export{Be as default};
